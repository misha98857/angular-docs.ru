# Сервисы Angular

В этом уроке показано, как создать сервис Angular и использовать внедрение зависимостей для его включения в ваше
приложение.

<docs-video src="https://www.youtube.com/embed/-jRxG84AzCI?si=rieGfJawp9xJ00Sz"/>

## Чему вы научитесь

В вашем приложении будет сервис для предоставления данных.
В конце этого урока сервис будет читать локальные статические данные.
В следующем уроке вы обновите сервис для получения данных от веб-сервиса.

## Концептуальный обзор сервисов

В этом руководстве представлены сервисы Angular и внедрение зависимостей.

### Сервисы Angular

_Сервисы Angular_ предоставляют способ разделения данных и функций приложения Angular, которые могут использоваться
несколькими компонентами.
Чтобы сервис можно было использовать в нескольких компонентах, он должен быть сделан _injectable_ (доступным для
внедрения).
Сервисы, доступные для внедрения и используемые компонентом, становятся зависимостями этого компонента.
Компонент зависит от этих сервисов и не может функционировать без них.

### Внедрение зависимостей (Dependency injection)

_Внедрение зависимостей_ — это механизм, который управляет зависимостями компонентов приложения и сервисами, которые
могут использовать другие компоненты.

<docs-workflow>

<docs-step title="Создание нового сервиса для вашего приложения">
На этом шаге создается сервис, доступный для внедрения в ваше приложение.

На панели **Terminal** вашей IDE:

1. В директории вашего проекта перейдите в папку `first-app`.
1. В директории `first-app` выполните следующую команду для создания нового сервиса.

```shell
ng generate service housing --skip-tests
```

1. Запустите `ng serve` для сборки приложения и его запуска по адресу `http://localhost:4200`.
1. Убедитесь, что приложение собирается без ошибок.
   Исправьте ошибки перед переходом к следующему шагу.
   </docs-step>

<docs-step title="Добавление статических данных в новый сервис">
На этом шаге добавляются примеры данных в ваш новый сервис.
В следующем уроке вы замените статические данные веб-интерфейсом для получения данных, как в реальном приложении.
Пока что новый сервис вашего приложения использует данные, которые были созданы локально в `Home`.

На панели **Edit** вашей IDE:

1. В `src/app/home/home.ts`, из `Home`, скопируйте переменную `housingLocationList` и её значение (массив).
1. В `src/app/housing.service.ts`:
1. Внутри класса `HousingService` вставьте переменную, скопированную из `Home` на предыдущем шаге.
1. Внутри класса `HousingService` вставьте эти функции после данных, которые вы только что скопировали.
   Эти функции позволяют зависимостям получать доступ к данным сервиса.

   <docs-code header="Функции сервиса в src/app/housing.service.ts" path="adev/src/content/tutorials/first-app/steps/10-routing/src/app/housing.service.ts" visibleLines="[112,118]"/>

   Эти функции понадобятся вам в будущем уроке. Пока достаточно понимать, что эти функции возвращают либо конкретный
   `HousingLocation` по id, либо весь список.

1. Добавьте импорт на уровне файла для `HousingLocation`.

   <docs-code header="Импорт типа HousingLocation в src/app/housing.service.ts" path="adev/src/content/tutorials/first-app/steps/10-routing/src/app/housing.service.ts" visibleLines="[2]"/>

1. Убедитесь, что приложение собирается без ошибок.
   Исправьте ошибки перед переходом к следующему шагу.
   </docs-step>

<docs-step title="Внедрение нового сервиса в `Home`">
На этом шаге новый сервис внедряется в `Home` вашего приложения, чтобы компонент мог читать данные приложения из сервиса.
В следующем уроке вы замените статические данные живым источником данных, как в реальном приложении.

На панели **Edit** вашей IDE, в файле `src/app/home/home.ts`:

1. В верхней части `src/app/home/home.ts` добавьте `inject` к элементам, импортируемым из `@angular/core`. Это
   импортирует функцию `inject` в класс `Home`.

<docs-code language="angular-ts" header="Обновление в src/app/home/home.ts" path="adev/src/content/tutorials/first-app/steps/10-routing/src/app/home/home.ts" visibleLines="[1]"/>

1. Добавьте новый импорт на уровне файла для `HousingService`:

<docs-code language="angular-ts" header="Добавление импорта в src/app/home/home.ts" path="adev/src/content/tutorials/first-app/steps/10-routing/src/app/home/home.ts" visibleLines="[4]"/>

1. В `Home` удалите записи массива `housingLocationList` и присвойте `housingLocationList` значение пустого массива (
   `[]`). Через несколько шагов вы обновите код для получения данных из `HousingService`.

1. В `Home` добавьте следующий код для внедрения нового сервиса и инициализации данных для приложения. `constructor` —
   это первая функция, которая запускается при создании этого компонента. Код в `constructor` присвоит
   `housingLocationList` значение, возвращаемое вызовом `getAllHousingLocations`.

<docs-code language="angular-ts" header="Инициализация данных из сервиса в src/app/home/home.ts" path="adev/src/content/tutorials/first-app/steps/10-routing/src/app/home/home.ts" visibleLines="[23,30]"/>

1. Сохраните изменения в `src/app/home/home.ts` и убедитесь, что ваше приложение собирается без ошибок.
   Исправьте ошибки перед переходом к следующему шагу.
   </docs-step>

</docs-workflow>

РЕЗЮМЕ: В этом уроке вы добавили сервис Angular в свое приложение и внедрили его в класс `Home`.
Это разделяет логику получения данных вашим приложением.
На данный момент новый сервис получает данные из статического массива.
В следующем уроке вы рефакторите сервис для получения данных из конечной точки API.

Для получения дополнительной информации по темам, рассмотренным в этом уроке, посетите:

<docs-pill-row>
  <docs-pill href="guide/di/creating-injectable-service" title="Создание injectable-сервиса"/>
  <docs-pill href="guide/di" title="Внедрение зависимостей в Angular"/>
  <docs-pill href="cli/generate/service" title="ng generate service"/>
  <docs-pill href="cli/generate" title="ng generate"/>
</docs-pill-row>
