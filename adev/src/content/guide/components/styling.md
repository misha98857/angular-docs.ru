# Стилизация компонентов

TIP: Это руководство предполагает, что вы уже ознакомились с [Руководством по основам](essentials). Сначала прочитайте
его, если вы новичок в Angular.

Компоненты могут опционально включать CSS-стили, которые применяются к DOM этого компонента:

```angular-ts {highlight:[4]}
@Component({
  selector: 'profile-photo',
  template: `<img src="profile-photo.jpg" alt="Your profile photo">`,
  styles: ` img { border-radius: 50%; } `,
})
export class ProfilePhoto { }
```

Вы также можете писать стили в отдельных файлах:

```angular-ts {highlight:[4]}
@Component({
  selector: 'profile-photo',
  templateUrl: 'profile-photo.html',
  styleUrl: 'profile-photo.css',
})
export class ProfilePhoto { }
```

Когда Angular компилирует ваш компонент, эти стили включаются в JavaScript-вывод компонента. Это означает, что стили
компонента участвуют в системе модулей JavaScript. При рендеринге компонента Angular фреймворк автоматически включает
связанные с ним стили, даже при ленивой загрузке компонента.

Angular работает с любым инструментом, который генерирует CSS,
включая [Sass](https://sass-lang.com), [less](https://lesscss.org) и [stylus](https://stylus-lang.com).

## Область видимости стилей

У каждого компонента есть настройка **инкапсуляции представления** (view encapsulation), которая определяет, как
фреймворк ограничивает область видимости стилей компонента. Существует четыре режима инкапсуляции представления:
`Emulated`, `ShadowDom`, `ExperimentalIsolatedShadowDom` и `None`.
Вы можете указать режим в декораторе `@Component`:

```angular-ts {highlight:[3]}
@Component({
  ...,
  encapsulation: ViewEncapsulation.None,
})
export class ProfilePhoto { }
```

### ViewEncapsulation.Emulated

По умолчанию Angular использует эмулированную инкапсуляцию, чтобы стили компонента применялись только к элементам,
определенным в шаблоне этого компонента. В этом режиме фреймворк генерирует уникальный HTML-атрибут для каждого
экземпляра компонента, добавляет этот атрибут к элементам в шаблоне компонента и вставляет его в CSS-селекторы,
определенные в стилях вашего компонента.

Этот режим гарантирует, что стили компонента не «утекут» наружу и не повлияют на другие компоненты. Однако глобальные
стили, определенные вне компонента, все еще могут влиять на элементы внутри компонента с эмулированной инкапсуляцией.

В эмулированном режиме Angular поддерживает псевдокласс [`:host`](https://developer.mozilla.org/docs/Web/CSS/:host).
Хотя псевдокласс [`:host-context()`](https://developer.mozilla.org/docs/Web/CSS/:host-context) устарел в современных
браузерах, компилятор Angular обеспечивает его полную поддержку. Оба псевдокласса можно использовать, не полагаясь на
нативный [Shadow DOM](https://developer.mozilla.org/docs/Web/Web_Components/Using_shadow_DOM).
Во время компиляции фреймворк преобразует эти псевдоклассы в атрибуты, поэтому во время выполнения они не подчиняются
правилам нативных псевдоклассов (например, совместимость с браузерами, специфичность). Режим эмулированной инкапсуляции
Angular не поддерживает другие псевдоклассы, связанные с Shadow DOM, такие как `::shadow` или `::part`.

#### `::ng-deep`

Режим эмулированной инкапсуляции Angular поддерживает пользовательский псевдокласс `::ng-deep`. Применение этого
псевдокласса к правилу CSS отключает инкапсуляцию для этого правила, фактически превращая его в глобальный стиль. \*
\*Команда Angular настоятельно не рекомендует использовать `::ng-deep` в новом коде\*\*. Эти API остаются исключительно для
обратной совместимости.

### ViewEncapsulation.ShadowDom

Этот режим ограничивает стили внутри компонента,
используя [веб-стандарт Shadow DOM API](https://developer.mozilla.org/docs/Web/Web_Components/Using_shadow_DOM).
При включении этого режима Angular присоединяет теневой корень (shadow root) к хост-элементу компонента и рендерит
шаблон и стили компонента в соответствующее теневое дерево (shadow tree).

Стили внутри теневого дерева не могут влиять на элементы за пределами этого теневого дерева.

Включение инкапсуляции `ShadowDom`, однако, влияет не только на область видимости стилей. Рендеринг компонента в теневом
дереве влияет на всплытие событий, взаимодействие с [API
`<slot>`](https://developer.mozilla.org/docs/Web/Web_Components/Using_templates_and_slots), а также на то, как
инструменты разработчика браузера отображают элементы. Всегда учитывайте все последствия использования Shadow DOM в
вашем приложении перед включением этой опции.

### ViewEncapsulation.ExperimentalIsolatedShadowDom

Ведет себя так же, как описано выше, за исключением того, что этот режим строго гарантирует, что _только_ стили этого
компонента применяются к элементам в его шаблоне. Глобальные стили не могут влиять на элементы в теневом дереве, а стили
внутри теневого дерева не могут влиять на элементы за его пределами.

### ViewEncapsulation.None

Этот режим отключает всю инкапсуляцию стилей для компонента. Любые стили, связанные с компонентом, ведут себя как
глобальные стили.

NOTE: В режимах `Emulated` и `ShadowDom` Angular не дает 100% гарантии, что стили вашего компонента всегда будут
переопределять стили, приходящие извне. Предполагается, что в случае конфликта эти стили имеют ту же специфичность, что
и стили вашего компонента.

## Определение стилей в шаблонах

Вы можете использовать элемент `<style>` в шаблоне компонента для определения дополнительных стилей. Режим инкапсуляции
представления компонента применяется к стилям, определенным таким образом.

Angular не поддерживает привязки внутри элементов style.

## Ссылка на внешние файлы стилей

Шаблоны компонентов могут использовать [элемент `<link>`](https://developer.mozilla.org/docs/Web/HTML/Element/link) для
ссылки на CSS-файлы. Кроме того, ваш CSS может использовать [at-правило
`@import`](https://developer.mozilla.org/docs/Web/CSS/@import) для ссылки на CSS-файлы. Angular рассматривает эти ссылки
как _внешние_ стили. На внешние стили не влияет эмулированная инкапсуляция представления.
